\section{Introduction}
\label{sec:intro}

%% introduce Rt 
Effective reproduction numbers (also called, instantaneous reproduction numbers) are a key to understand infectious disease dynamics including the potential sizes of a pandemic, the scale of epidemic prevention measures, and the effectiveness of control effects. 
They are expected numbers of secondary infections caused by an infected individual in a population, and a time series that can reflect the effect of time-varying factors, such as intervention policy and population immunity. 
Let $\calR_t$ be the effective reproduction number at time $t$. A practical interpretation is that $\calR_t < 1$ represents a circumstance when the infection dies out gradually and achieves a \textit{disease-free equilibrium}, whereas when $\calR_t > 1$, the infection is always present, which leads to the \textit{endemic equilibrium}. 
%
%% significance/necessity of modeling Rt: 
Effective reproduction numbers reveal an unobservable biological reality. 
There exist a number of models to uncover this reality relying on various domain-specific assumptions and using different types of observed data such as incidence data and death rates. 
%% properties: accurate and robust to violation of assumptions 
Estimation of effective reproduction numbers relies heavily on the quality of the available data. Due to the limitations of data collection, such as underreporting and lack of standardization, epidemiological models, however, need to make \textit{accurate} estimations given the poor quality of data. Since model assumptions may not be verified in practice, it is also critical for an estimator to be \textit{robust} to model misspecification. 
%% usage: retrospective or real-time estimation, and prediction

%% literature review: Bayesian approaches: EpiEstim, EpiFilter, EpiNow2, EpiNowCast
Many existing approaches for effective reproduction number estimation are Bayesian approaches that estimate posterior distributions of $\calR_t$. \EpiEstim \citep{cori2020package}, proposed by \cite{cori2013new}, is a Bayesian approach solving the posterior distribution of $\calR_t$ given incidence data prior to time $t$. An advantage of \EpiEstim\ is that it only depends on limited assumptions (the Poisson distributed incidences, the prior distribution of effective reproduction number, and the serial interval distribution) and only requires incidence data which is easily obtainable. For these reasons, \EpiEstim\ does not require much domain expertise in implementation. It is one of the earliest approaches that are both succinct and accurate in $\calR_t$ estimation. They proposed an upgraded version \texttt{EpiEstim(2.2)} in \cite{thompson2019improved}, which distinguished imported cases from local transmission and simultaneously estimated the serial interval. They further extended \EpiEstim\ by using ``reconstructed'' daily incidence data to overcome the issue when incidences were not always daily records in \cite{nash2023estimating}. 
% bayEstim is a version of implementation of {cori2013new} and {thompson2019improved}. 
% 
\cite{abbott2020estimating} proposed a Bayesian latent variable framework, \texttt{EpiNow2} \citep{EpiNow2}, which uses both incidence and death counts for a precise $\calR_t$ estimation. They further proposed a generative Bayesian model to handle missing data by imputation followed by truncation adjustment in \cite{lison2023generative}. 
%
\cite{parag2021improved} proposed an alternative Bayesian approach, \texttt{EpiFilter}, that is a recursive Bayesian smoother based on Kalman Filter. \texttt{EpiFilter} also solves the posteriori of $\calR_t$ given a Gamma prior and Poisson distributed infection counts. Compared to \EpiEstim, \texttt{EpiFilter} estimates $\calR_t$ retrospectively using all available incidences both prior and subsequent to time $t$, and provides robust estimation in low incidence cases.  
%koyama2021estimating: devised a state-space method for fitting a discrete-time variant of the Hawkes process to a given dataset of daily
\cite{gressani2022epilps} proposed a Bayesian P-splines approach, \EpiLPS, that assumes negative Binomial distributed incidence. 
\cite{trevisin2023spatially} proposed a Bayesian model based on particle filtering to estimate spatially explicit effective reproduction numbers.
%
Bayesian approaches estimate the posterior distribution of the effective reproduction numbers with the advantage that the credible intervals can be easily computed. A limitation of many Bayesian approaches is that they usually require heavy computational workload, especially when data sequences are long or hierarchical structures are complex.  % We compare our model to two computationally efficient Bayesian models, EpiEstim and EpiLPS. 

There are also frequentist approaches. 
\cite{abry2020spatial} proposed to regularize the smoothness of $\calR_t$ regarding its temporal and spatial evolution. They considered a penalized regression with a second-order temporal regularization and a spatial regularization on $\calR_t$ and with Poisson loss. They further extended it by introducing another penalty on outliers for robustness in \cite{pascal2022nonsmooth}.  
%
\cite{pircal2023spline} is a spline-based model relying on the assumption of exponential-family distributed incidences. %but in a more continuous-time setting. [Important!] 
\cite{ho2023accounting} estimates $\calR_t$ while monitoring the time-varying level of overdispersion. 
%
There are other spline-based approaches such as \cite{azmon2014estimation,gressani2021approximate,pircalabelu2023spline}, regressive models with random effects \citep{jin2023epimix} that is robust to low incidence cases, and generalized autoregresive moving average (GARMA) model \citep{hettinger2023estimating} that is robust to measurement errors in incidences. 
%\cite{jin2023epimix} proposed EpiMix, which included exogenous factors other than incidence cases, and introduced random effects in regression model. It is also robust against low incidence cases. 
%
%There are many other practical considerations in effective reproduction number estimation. \cite{hettinger2023estimating} proposed a generalized autoregresive moving average (GARMA) model, which solved the bias introduced by practical concerns such as particular forms of measurement errors in incidence data. They also incorporates multiple serial interval distributions. %Basically extended EpiEstim. 
%and compartmental models. 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% our approach %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
We propose a retrospective effective reproduction number estimation approach, called \RtEstim, that requires only the daily incidence data based on the assumptions of Poisson incidences and Gamma serial interval functions. It makes our approach straightforward and depending on little expertise in domain knowledge for implementation. \RtEstim\ produces accurate estimations that are empirically robust in model misspecification, i.e., the violation of distributional assumption of incidences. 
% 
It is a convex optimization problem with Poisson loss and $\ell_1$ penalty on the temporal evolution of $\calR_t$, which is known as the trend filtering penalty \citep{kim2009ell_1,tibshirani2014adaptive,sadhanala2022exponential}. Thus, \RtEstim\ is a \textit{Poisson trend filtering} problem. \cite{sadhanala2022exponential} proposed trend filtering with exponential family loss on lattices. Here, we focus on Poisson loss on univariate data that is modified to integrate the serial interval functions. Our \RtEstim\ generates discrete splines, and the estimated curves appear to be piecewise polynomials. The estimators have the property of local adaptivity, i.e., heterogeneous smoothness throughout the range of time, and facilitate the computational efficiency. %We follow the common assumption of Poisson distributed incidence data, but the empirical study shows that the estimators are robust in negative binomial settings. 
%Thus, RtEstim is accurate, robust in model misspecification, and computationally efficient. 
% the approach we focus 
We propose a proximal Newton method to solve the convex optimization problem. Our approach takes the advantage of convex optimization and is solved by Newton's method, which is known to converge rapidly. %We provide a more computationally efficient algorithm for the lowest-degree problem, where iterative algorithms can be avoided. 
Moreover, the sparse structure of the divided difference matrix used in the trend filtering penalty allows further efficiency in computation. 
%Temporal evolution of reproduction numbers considers the progression of reproduction numbers that occurs over time through different temporal intervals. 
We show empirically that our approach is more accurate than existing methods given the specific structures of the effective reproduction numbers. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% overview %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
The manuscript unfolds as follows. We first introduce the methodology of \RtEstim\ including the usage of renewal equation, the development of Poisson trend filtering estimator, and the proximal Newton algorithm. The methodology is followed by the interpretation from an alternative Bayesian perspective. We run experiments to compare our estimator to \EpiEstim\ and \EpiLPS, which are both Bayesian competitors that are both accurate and computationally efficient. We then apply our \RtEstim\ on the Covid-19 pandemic incidence in British Columbia and the 1918 influenza pandemic in the united states. More discussion on advantages and limitations of our approach and more practical considerations in the effective reproduction number estimation follows in the end. 
